pipeline {
  agent any
 
  parameters {
    choice(
        name: 'SERVER', 
        description: 'Servidor donde ejecutar el proceso',
        choices: ["TODOS", "SERVIDOR 1", "SERVIDOR 2", "SERVIDOR 3"]
       )
  } 
  stages {
    stage('Execute task in bd') {
      steps {
        script {
           def executors = [:]
           servers = readJSON file: "servers.json"
           servers['SERVERS'].each {
              server ->  
                    executors[server] = {
                            node {
                                stage("${server}") {
                                    echo '${server}'
                                }
                            }
                    }
                   
              }
              parallel servers
        }
      }
    }
  }
}
